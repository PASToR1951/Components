<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>404 - Page Not Found</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        :root {
            --theme-gold: #FDB813;
            --theme-gold-darker: #EAA10F;
            --theme-gold-light-bg: rgba(253, 184, 19, 0.2);
            --theme-gold-lighter-bg: rgba(253, 184, 19, 0.1);
            --theme-gold-highlight: rgba(253, 184, 19, 0.4);
            --theme-green-dark: #006A4E;
            --theme-green-darker-text: #00523D;
            --theme-green-light-bg: rgba(0, 106, 78, 0.3);
            --theme-green-lighter-bg: rgba(0, 106, 78, 0.15);
            --theme-green-border: rgba(0, 106, 78, 0.7);
            --theme-page-bg: #F9F6EE;
            --neutral-border-color: #e5e7eb;
            --input-border-color: #d1d5db;
            --placeholder-text-color: #9ca3af;
            --text-on-gold: #000000;
            --text-on-green: #FFFFFF;
            --primary-text-color: #1f2937;
            --secondary-text-color: #4b5563;
            --tertiary-text-color: #6b7280;
            --theme-accent-gray: #6b7280;
            --pastel-gold: #FFF5CC;
            --pastel-green: #D0EAD0;
            --footer-glass-bg-color: rgba(255, 255, 255, 0.25);
            --footer-glass-border-color: rgba(255, 255, 255, 0.4);
            --footer-glass-blur-radius: 6px;
        }

        html { height: 100%; box-sizing: border-box; }
        *, *:before, *:after { box-sizing: inherit; }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--theme-page-bg);
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23D3CBBF' fill-opacity='0.1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            color: var(--primary-text-color);
            min-height: 100vh; display: flex; flex-direction: column; margin: 0;
            overflow-x: hidden; user-select: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none;
            transition: background-image 0.5s ease-in-out, background-color 0.5s ease-in-out;
        }

        input, textarea { user-select: auto; -webkit-user-select: auto; -moz-user-select: auto; -ms-user-select: auto; }

        .page-wrapper {
            flex-grow: 1; display: flex; flex-direction: column;
            padding-top: 3rem;
        }
        @media (min-width: 768px) { .page-wrapper { padding-top: 4rem; } }

        h2 { /* Main title for 404 page */
            font-family: 'Inter', sans-serif; color: var(--primary-text-color);
            font-weight: 600; margin-top: 0;
        }

        .container {
            width: 100%; margin-left: auto; margin-right: auto;
            padding-left: 1rem; padding-right: 1rem;
        }
        @media (min-width: 640px) { .container { max-width: 640px; padding-left: 1.5rem; padding-right: 1.5rem; } }
        @media (min-width: 768px) { .container { max-width: 768px; } }
        @media (min-width: 1024px) { .container { max-width: 1024px; padding-left: 2rem; padding-right: 2rem; } }
        @media (min-width: 1280px) { .container { max-width: 1280px; } }
        @media (min-width: 1536px) { .container { max-width: 1536px; } }

        .btn {
            padding: 0.75rem 1.5rem; border-radius: 0.5rem; font-weight: 600; text-align: center;
            transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease, opacity 0.3s ease, transform 0.3s ease, box-shadow 0.2s ease;
            display: inline-flex; align-items: center; justify-content: center; gap: 0.6rem;
            font-size: 1rem; line-height: 1.5rem; box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            cursor: pointer; text-decoration: none; border: 1px solid transparent;
            user-select: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none;
        }
        .btn:hover { box-shadow: 0 4px 12px rgba(0,0,0,0.12); transform: translateY(-2px); }
        .btn-primary { background-color: var(--theme-green-dark); color: var(--text-on-green); border-color: var(--theme-green-dark); }
        .btn-primary:hover { background-color: var(--theme-green-darker-text); border-color: var(--theme-green-darker-text); }
        .btn-secondary { background-color: var(--theme-gold); color: var(--text-on-gold); border-color: var(--theme-gold); }
        .btn-secondary:hover { background-color: var(--theme-gold-darker); border-color: var(--theme-gold-darker); }
        .btn i, .btn svg { width: 1.25rem; height: 1.25rem; }

        .footer-wrapper { margin-top: auto; width: 100%; }
        .site-footer {
            position: relative; overflow: hidden;
            background-color: var(--footer-glass-bg-color);
            -webkit-backdrop-filter: blur(var(--footer-glass-blur-radius));
            backdrop-filter: blur(var(--footer-glass-blur-radius));
            border-top: 1px solid var(--footer-glass-border-color);
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.08); color: #374151;
            transition: background-image 0.5s ease-in-out, background-color 0.5s ease-in-out;
        }
        @keyframes subtleGradientAnimation { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .site-footer::before {
            content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0; z-index: -1;
            background: linear-gradient(45deg, var(--pastel-gold), var(--pastel-green), var(--pastel-gold));
            background-size: 200% 200%; animation: subtleGradientAnimation 18s ease infinite;
            opacity: 0.7; transition: opacity 0.5s ease-in-out;
        }
        .party-mode .site-footer::before { opacity: 0; }
        .footer-content-padding { position: relative; z-index: 1; padding: 2rem 1.5rem; max-width: 80rem; margin-left: auto; margin-right: auto; }
        @media (min-width: 640px) { .footer-content-padding { padding-left: 2rem; padding-right: 2rem; } }
        @media (min-width: 1024px) { .footer-content-padding { padding-left: 2.5rem; padding-right: 2.5rem; } }
        .footer-layout { display: flex; flex-direction: column; align-items: center; gap: 1.5rem; text-align: center; }
        @media (min-width: 1024px) { .footer-layout { flex-direction: row; justify-content: space-between; align-items: flex-start; text-align: left; } }
        .footer-logo-section { flex-shrink: 0; }
        .footer-logo-container { display: flex; flex-direction: column; align-items: center; text-align: center; margin-bottom: 0.5rem; }
        .footer-logo-container img { height: 3.5rem; width: auto; margin-bottom: 0.5rem; transition: filter 0.5s ease-in-out; }
        @media (min-width: 1024px) { .footer-logo-container { align-items: flex-start; } }
        .footer-nav { display: flex; flex-wrap: wrap; justify-content: center; gap: 0.75rem 1.5rem; font-size: 0.875rem; }
        @media (min-width: 1024px) { .footer-nav { justify-content: flex-start; gap: 0.5rem 1.5rem; } }
        .footer-link { color: var(--theme-green-dark); transition: color 0.2s ease-in-out, opacity 0.2s ease-in-out, text-shadow 0.5s ease-in-out; text-decoration: none; font-weight: 500; }
        .footer-link:hover { color: var(--theme-gold); opacity: 0.85; }
        .copyright-text { color: var(--tertiary-text-color); font-size: 0.875rem; transition: color 0.5s ease-in-out, text-shadow 0.5s ease-in-out; }

        .notfound-main-content {
            flex-grow: 1; display: flex; flex-direction: column; align-items: center; justify-content: center;
            text-align: center; padding: 2rem 1rem; position: relative; /* For positioning interactive icons */
            overflow: hidden; /* To contain icons that might move slightly outside direct bounds */
        }
        .notfound-graphic {
            font-size: 8rem; font-weight: 700; color: var(--theme-green-dark); margin-bottom: 0.5rem; position: relative;
            animation: bounceIn 0.8s ease-out; min-height: 150px; display: flex; align-items: center; justify-content: center;
            user-select: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none;
            overflow: hidden; padding: 10px; border-radius: 10px;
        }
        .notfound-graphic.game-active .char:not(.party-char) { opacity: 0.7; transition: opacity 0.3s ease; }
        .notfound-graphic .char {
            display: inline-block; animation: subtleBob 3s ease-in-out infinite;
            transition: transform 0.2s ease-out, opacity 0.3s ease, color 0.5s ease-in-out;
        }
        .notfound-graphic .char:nth-child(1) { animation-delay: 0s, 0s; }
        .notfound-graphic .char:nth-child(2) { animation-delay: 0.2s; color: var(--theme-gold-darker); cursor: pointer; }
        .notfound-graphic .char:nth-child(3) { animation-delay: 0.4s, 0s; }
        @keyframes bounceIn { 0% { transform: scale(0.5); opacity: 0; } 70% { transform: scale(1.05); } 100% { transform: scale(1); opacity: 1; } }
        @keyframes subtleBob { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

        .notfound-title {
            font-family: 'Libre Baskerville', serif; font-size: 2rem; color: var(--primary-text-color); margin-bottom: 1rem;
            animation: fadeIn 1s ease-out 0.5s backwards;
            user-select: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none;
        }
        @media (min-width: 640px) { .notfound-graphic { font-size: 10rem; min-height: 200px; } .notfound-title { font-size: 2.5rem; } }
        @media (min-width: 1024px) { .notfound-graphic { font-size: 12rem; min-height: 250px; } .notfound-title { font-size: 3rem; } }

        .notfound-message {
            font-size: 1.125rem; color: var(--secondary-text-color); max-width: 500px; margin-bottom: 1.5rem;
            line-height: 1.7; animation: fadeIn 1s ease-out 0.8s backwards;
            user-select: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none;
        }
        
        .game-info-display {
            margin-top: 0.5rem; margin-bottom: 1.5rem; min-height: 40px; display: none;
            flex-direction: column; align-items: center; gap: 0.25rem;
            user-select: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none;
        }
        .game-info-display.active { display: flex; animation: fadeIn 0.5s ease-out; }
        #game-score-main, #game-message-main { font-size: 1rem; color: var(--primary-text-color); font-weight: 500; text-align: center; }
        #game-message-main { color: var(--theme-green-dark); font-weight: 600; }
        .notfound-actions { display: flex; flex-direction: column; gap: 1rem; animation: fadeIn 1s ease-out 1.1s backwards; }
        @media (min-width: 640px) { .notfound-actions { flex-direction: row; } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* Removed ::before and ::after for .notfound-main-content, replaced by interactive-icon divs */

        .interactive-icon {
            position: absolute;
            width: 50px; /* Adjust size as needed */
            height: 50px;
            opacity: 0.25; /* Subtle appearance */
            transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.3s ease; /* Smooth, slightly bouncy transition */
            pointer-events: none; /* So they don't interfere with other clicks */
            z-index: -1; /* Behind main text content, but above background pattern */
        }
        .interactive-icon svg {
            width: 100%;
            height: 100%;
        }
        .party-mode .interactive-icon {
            opacity: 0.1; /* Further dim during party mode */
        }


        .game-object {
            position: absolute; width: 35px; height: 35px; font-size: 1.8rem; cursor: pointer;
            transition: transform 0.1s ease-out;
            user-select: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none;
            display: flex; align-items: center; justify-content: center; z-index: 10;
        }
        .game-object:hover { transform: scale(1.2); }

        @keyframes rainbowBackgroundParty { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        body.party-mode {
            background-image: linear-gradient(120deg, hsl(0, 100%, 70%), hsl(30, 100%, 70%), hsl(60, 100%, 70%), hsl(120, 100%, 70%), hsl(180, 100%, 70%), hsl(240, 100%, 70%), hsl(300, 100%, 70%), hsl(0, 100%, 70%));
            background-size: 1400% 1400%; animation: rainbowBackgroundParty 10s linear infinite;
        }
        .party-mode .site-footer {
            background-image: linear-gradient(120deg, hsl(0, 100%, 65%), hsl(40, 100%, 65%), hsl(80, 100%, 65%), hsl(140, 100%, 65%), hsl(200, 100%, 65%), hsl(260, 100%, 65%), hsl(320, 100%, 65%), hsl(0, 100%, 65%)) !important;
            background-size: 1400% 1400% !important; animation: rainbowBackgroundParty 12s linear infinite reverse;
        }
        .party-mode .footer-link, .party-mode .copyright-text {
            color: #fff !important; text-shadow: 0 0 5px rgba(0,0,0,0.7), 0 0 10px rgba(0,0,0,0.5);
        }
        .party-mode .footer-logo-container img { filter: drop-shadow(2px 2px 3px rgba(0,0,0,0.5)) brightness(1.1); }
        .party-mode .notfound-graphic .char {
            animation: rainbowTextParty 2s linear infinite, subtleBob 3s ease-in-out infinite; opacity: 1 !important;
        }
        .party-mode .notfound-graphic .char.party-char:nth-child(1) { animation-delay: 0s, 0s !important; }
        .party-mode .notfound-graphic .char.party-char:nth-child(2) { animation-delay: -0.66s, 0.2s !important; cursor: default !important; }
        .party-mode .notfound-graphic .char.party-char:nth-child(3) { animation-delay: -1.33s, 0.4s !important; }
        @keyframes rainbowTextParty {
            0%, 100% { color: hsl(0, 100%, 70%); } 16% { color: hsl(60, 100%, 70%); }
            33% { color: hsl(120, 100%, 70%); } 50% { color: hsl(180, 100%, 70%); }
            66% { color: hsl(240, 100%, 70%); } 83% { color: hsl(300, 100%, 70%); }
        }
        .confetti {
            position: fixed; width: 10px; height: 10px; opacity: 0.9;
            pointer-events: none; z-index: 9999; animation: fall linear; border-radius: 0%;
        }
        .confetti.triangle {
            width: 0; height: 0; border-left: 7px solid transparent; border-right: 7px solid transparent;
            border-bottom: 12px solid red; background-color: transparent !important; border-radius: 0;
        }
        .confetti.circle { border-radius: 50%; }
        @keyframes fall { to { transform: translateY(105vh) rotate(720deg); opacity: 0; } }
    </style>
</head>
<body>
    <div class="page-wrapper">
        <main class="notfound-main-content container" role="main">
            <div class="interactive-icon" id="icon-doc-broken" style="top: 15%; left: 10%;">
                <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm-1.03 9.03L12 10.06l-1.03.97a.75.75 0 0 1-1.06-1.06l1.5-1.5a.75.75 0 0 1 1.06 0l1.5 1.5a.75.75 0 1 1-1.06 1.06zM13 9V3.5L18.5 9H13zm-1.5 4.5c0 .83-.67 1.5-1.5 1.5s-1.5-.67-1.5-1.5.67-1.5 1.5-1.5 1.5.67 1.5 1.5zM9.5 17H8v-2h1.5v2zm3 0h-1.5v-2H11v2zm3 0h-1.5v-2H14v2z"/></svg>
            </div>
            <div class="interactive-icon" id="icon-question" style="top: 70%; left: 85%;">
                <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-1.1 0-2 .9-2 2h2c0-.55.45-1 1-1s1 .45 1 1c0 .79-.44 1.18-1.21 1.79-.61.48-1.29 1.02-1.29 2.21h2c0-.9.55-1.27 1.29-1.8.6-.43 1.21-.98 1.21-2.2C15 7.9 13.66 6 12 6zm0 10c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"/></svg>
            </div>
             <div class="interactive-icon" id="icon-folder-search" style="top: 80%; left: 15%;">
                <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-2.53 9.47l-2.12 2.12a.75.75 0 0 1-1.06 0l-2.12-2.12a.75.75 0 0 1 1.06-1.06l.78.79V12.5a.75.75 0 0 1 1.5 0v2.69l.78-.79a.75.75 0 0 1 1.06 1.07zM15.5 11a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"/></svg>
            </div>
            <div class="interactive-icon" id="icon-paper-plane" style="top: 20%; left: 80%; width: 40px; height: 40px;"> <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
            </div>

            <div class="notfound-graphic" id="gameArea" aria-hidden="true">
                <span class="char">4</span>
                <span class="char" id="gameTriggerElement">0</span>
                <span class="char">4</span>
            </div>
            <div class="game-info-display" id="gameInfoDisplay">
                <div id="game-score-main">Score: 0</div>
                <div id="game-message-main"></div>
            </div>

            <h2 class="notfound-title">Oops! Document Misplaced</h2>
            <p class="notfound-message">
                It seems the page you're looking for has been archived, moved, or perhaps never existed.
                Let's get you back on track.
            </p>
            <div class="notfound-actions">
                <a href="/" class="btn btn-primary">
                    <i class="fas fa-home" aria-hidden="true"></i>
                    Go to Homepage
                </a>
                <a href="/contact" class="btn btn-secondary">
                    <i class="fas fa-envelope" aria-hidden="true"></i>
                    Contact Support
                </a>
            </div>
        </main>
    </div>

    <div class="footer-wrapper">
        <footer id="site-footer-element" class="site-footer" role="contentinfo">
            <div class="footer-content-padding">
                <div class="footer-layout">
                    <div class="footer-logo-section">
                        <div class="footer-logo-container">
                            <img
                                id="footerPeASLogo"
                                src="https://placehold.co/200x80/006A4E/FFFFFF?text=PeAS+Logo"
                                alt="PeAS Logo"
                                onerror="this.onerror=null; this.src='https://placehold.co/200x80/cccccc/ffffff?text=Logo+Error';">
                        </div>
                        <p class="copyright-text">&copy; <span id="footerCurrentYear"></span> PeAS. All Rights Reserved.</p>
                    </div>
                    <nav class="footer-nav" role="navigation" aria-label="Footer Navigation">
                        <a href="/" class="footer-link">Home</a>
                        <a href="/contact" class="footer-link">Contact</a>
                        <a href="/terms" class="footer-link">Terms & Conditions</a>
                        <a href="/privacy" class="footer-link">Privacy Policy</a>
                    </nav>
                </div>
            </div>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const yearElement = document.getElementById('footerCurrentYear');
            if (yearElement) { yearElement.textContent = new Date().getFullYear(); }

            const homeButton = document.querySelector('.notfound-actions .btn-primary');
            if (homeButton) { homeButton.addEventListener('click', (e) => { e.preventDefault(); alert('Imagine you are being redirected to the Homepage!'); }); }
            const contactButton = document.querySelector('.notfound-actions .btn-secondary');
            if (contactButton) { contactButton.addEventListener('click', (e) => { e.preventDefault(); alert('Imagine you are being redirected to the Contact Page!'); }); }

            const gameTriggerElement = document.getElementById('gameTriggerElement');
            const gameArea = document.getElementById('gameArea');
            const gameInfoDisplay = document.getElementById('gameInfoDisplay');
            const gameScoreDisplay = document.getElementById('game-score-main');
            const gameMessageDisplay = document.getElementById('game-message-main');
            const notFoundChars = gameArea.querySelectorAll('.char');

            let triggerClickCount = 0;
            const clicksToTriggerGame = 3;
            let gameScore = 0;
            const scoreToWin = 5;
            let gameActive = false;
            let gameObjectInterval;
            let triggerTimeout;
            let partyModeTimeout;

            const fileEmojis = ['📄', '📰', '📜', '📑', '📂', '🗂️'];
            const confettiColors = ['#ff5733', '#ffbd33', '#fcff33', '#75ff33', '#33ffbd', '#33acff', '#9033ff', '#ff33f6'];
            const confettiShapes = ['square', 'circle', 'triangle'];

            // Interactive Icons Logic
            const interactiveIcons = document.querySelectorAll('.interactive-icon');
            const mainContentArea = document.querySelector('.notfound-main-content');

            if (mainContentArea) {
                mainContentArea.addEventListener('mousemove', (e) => {
                    if (document.body.classList.contains('party-mode')) return; // Disable effect during party mode

                    const rect = mainContentArea.getBoundingClientRect();
                    // Cursor position relative to the main content area
                    const mouseX = e.clientX - rect.left;
                    const mouseY = e.clientY - rect.top;

                    interactiveIcons.forEach(icon => {
                        const iconRect = icon.getBoundingClientRect();
                        // Icon center relative to the main content area
                        const iconCenterX = (iconRect.left - rect.left) + iconRect.width / 2;
                        const iconCenterY = (iconRect.top - rect.top) + iconRect.height / 2;

                        const deltaX = mouseX - iconCenterX;
                        const deltaY = mouseY - iconCenterY;
                        
                        // Max distance for full effect, e.g., 300px
                        const maxDist = 300; 
                        const dist = Math.sqrt(deltaX * deltaX + deltaY * deltaY);

                        // How much to move the icon, decreases with distance
                        const moveFactor = Math.max(0, (maxDist - dist) / maxDist); 
                        
                        // Max movement in pixels
                        const maxMove = 10; 
                        
                        const moveX = (deltaX / dist) * maxMove * moveFactor * -1; // Move away from cursor slightly
                        const moveY = (deltaY / dist) * maxMove * moveFactor * -1; // Move away from cursor slightly

                        // Apply subtle rotation based on proximity/angle
                        const angle = Math.atan2(deltaY, deltaX) * (180 / Math.PI);
                        const rotateFactor = moveFactor * 5; // Max rotation 5 degrees

                        if (dist < maxDist) { // Only apply effect if cursor is close enough
                             icon.style.transform = `translate(${moveX}px, ${moveY}px) rotate(${angle * moveFactor * 0.1}deg) scale(${1 + moveFactor * 0.05})`;
                        } else {
                            icon.style.transform = 'translate(0px, 0px) rotate(0deg) scale(1)';
                        }
                    });
                });
                 mainContentArea.addEventListener('mouseleave', () => {
                     interactiveIcons.forEach(icon => {
                        icon.style.transform = 'translate(0px, 0px) rotate(0deg) scale(1)';
                     });
                 });
            }


            if (gameTriggerElement && gameArea && gameInfoDisplay && gameScoreDisplay && gameMessageDisplay) {
                gameScoreDisplay.style.display = 'none';
                gameMessageDisplay.textContent = '';

                gameTriggerElement.addEventListener('click', () => {
                    if (gameActive || document.body.classList.contains('party-mode')) return;

                    triggerClickCount++;
                    gameTriggerElement.style.transition = 'transform 0.1s ease-out';
                    gameTriggerElement.style.transform = `scale(${1 + triggerClickCount * 0.1})`;
                    setTimeout(() => { gameTriggerElement.style.transform = 'scale(1)'; }, 150);

                    clearTimeout(triggerTimeout);
                    if (triggerClickCount >= clicksToTriggerGame) {
                        startGame();
                        triggerClickCount = 0;
                    } else {
                        triggerTimeout = setTimeout(() => { triggerClickCount = 0; }, 1500);
                    }
                });
            } else {
                console.error("Easter egg game elements not found!");
            }

            function startGame() {
                if (gameActive) return;
                clearTimeout(triggerTimeout);
                gameActive = true;
                gameScore = 0;

                gameArea.classList.add('game-active');
                notFoundChars.forEach(c => c.classList.remove('party-char'));
                gameInfoDisplay.classList.add('active');
                gameScoreDisplay.style.display = 'block';
                updateScoreDisplay();
                gameMessageDisplay.textContent = `Find ${scoreToWin} files!`;

                spawnGameObject();
                gameObjectInterval = setInterval(spawnGameObject, 1200 + Math.random() * 800);
            }

            function endGame(isWin) {
                if (!gameActive) return;
                gameActive = false;
                gameArea.classList.remove('game-active');
                clearInterval(gameObjectInterval);
                clearTimeout(partyModeTimeout);

                const existingObjects = gameArea.querySelectorAll('.game-object');
                existingObjects.forEach(obj => obj.remove());

                if (isWin) {
                    gameMessageDisplay.textContent = "Congratulations! You found all the lost files!";
                    gameScoreDisplay.textContent = `Final Score: ${gameScore}`;
                    startPartyMode();
                    alert("You're an Archival Ace!"); 
                    
                    partyModeTimeout = setTimeout(() => {
                        stopPartyMode();
                        resetGameDisplayToHidden();
                    }, 8000);
                } else {
                    gameMessageDisplay.textContent = "Game Over.";
                    resetGameDisplayToHidden();
                }
                triggerClickCount = 0;
            }

            function startPartyMode() {
                document.body.classList.add('party-mode');
                notFoundChars.forEach(c => c.classList.add('party-char'));
                startConfetti();
            }

            function stopPartyMode() {
                document.body.classList.remove('party-mode');
                notFoundChars.forEach(c => c.classList.remove('party-char'));
                stopConfetti();
            }
            
            function resetGameDisplayToHidden() {
                if (!gameActive && !document.body.classList.contains('party-mode')) {
                    gameInfoDisplay.classList.remove('active');
                    gameScoreDisplay.style.display = 'none';
                    gameMessageDisplay.textContent = '';
                }
            }

            let confettiIntervalId;
            function createConfettiPiece() {
                const confettiPiece = document.createElement('div');
                confettiPiece.classList.add('confetti');
                const shape = confettiShapes[Math.floor(Math.random() * confettiShapes.length)];
                const color = confettiColors[Math.floor(Math.random() * confettiColors.length)];
                if (shape === 'triangle') {
                    confettiPiece.classList.add('triangle');
                    confettiPiece.style.borderBottomColor = color;
                } else {
                    confettiPiece.style.backgroundColor = color;
                    if (shape === 'circle') { confettiPiece.classList.add('circle'); }
                }
                confettiPiece.style.left = Math.random() * 100 + 'vw';
                confettiPiece.style.top = -20 + 'px';
                const duration = Math.random() * 3 + 4;
                confettiPiece.style.animationDuration = duration + 's';
                document.body.appendChild(confettiPiece);
                setTimeout(() => { confettiPiece.remove(); }, duration * 1000 + 500);
            }

            function startConfetti() {
                stopConfetti();
                for (let i = 0; i < 60; i++) { setTimeout(createConfettiPiece, i * 30); }
                confettiIntervalId = setInterval(createConfettiPiece, 250);
            }

            function stopConfetti() {
                clearInterval(confettiIntervalId);
                const existingConfetti = document.querySelectorAll('.confetti');
                existingConfetti.forEach(c => c.remove());
            }

            function spawnGameObject() {
                if (!gameActive || gameArea.querySelectorAll('.game-object').length > 4) return;
                const obj = document.createElement('div');
                obj.classList.add('game-object');
                obj.textContent = fileEmojis[Math.floor(Math.random() * fileEmojis.length)];
                const gameAreaRect = gameArea.getBoundingClientRect();
                const areaHeight = gameAreaRect.height > 50 ? gameAreaRect.height : 150;
                const areaWidth = gameAreaRect.width > 50 ? gameAreaRect.width : 200;
                const objSize = 35;
                obj.style.left = Math.random() * (areaWidth - objSize - 10) + 5 + 'px';
                obj.style.top = Math.random() * (areaHeight - objSize - 10) + 5 + 'px';
                obj.addEventListener('click', (e) => {
                    e.stopPropagation();
                    if (!gameActive) return;
                    gameScore++;
                    updateScoreDisplay();
                    obj.remove();
                    if (gameScore >= scoreToWin) {
                        endGame(true);
                    } else {
                        gameMessageDisplay.textContent = `Found ${gameScore}! ${scoreToWin - gameScore} more to go...`;
                    }
                });
                gameArea.appendChild(obj);
                setTimeout(() => { if (obj.parentElement) { obj.remove(); } }, 2500 + Math.random() * 1500);
            }

            function updateScoreDisplay() {
                gameScoreDisplay.textContent = `Files Found: ${gameScore}`;
            }
        });
    </script>
</body>
</html>
